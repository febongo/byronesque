<?php


class Mo_Openid_Recaptcha
{
    function mo_openid_get_client_ip()
    {
        if (!empty($_SERVER["\110\x54\x54\x50\x5f\x43\114\x49\x45\116\x54\x5f\x49\x50"])) {
            goto fIp;
        }
        if (!empty($_SERVER["\x48\x54\124\x50\x5f\x58\137\106\117\122\127\x41\x52\x44\x45\104\137\106\117\x52"])) {
            goto TzV;
        }
        return $_SERVER["\122\x45\115\117\x54\105\x5f\101\104\x44\122"];
        goto qHC;
        fIp:
        return $_SERVER["\x48\x54\124\x50\137\x43\x4c\111\105\x4e\124\x5f\x49\120"];
        goto qHC;
        TzV:
        return $_SERVER["\x48\x54\124\x50\137\130\137\106\117\x52\127\x41\122\x44\105\104\x5f\x46\x4f\122"];
        qHC:
        return '';
    }
    function verify()
    {
        $Tr = false;
        $uV = new CustomerOpenID();
        if (!isset($_POST["\x67\55\x72\145\x63\x61\160\164\143\150\141\x2d\x72\145\x73\160\157\156\163\x65"])) {
            goto fxt;
        }
        $ST = $this->mo_openid_get_client_ip();
        $sM = "\x68\x74\x74\160\163\x3a\x2f\57\167\167\x77\x2e\x67\157\x6f\147\154\x65\56\x63\x6f\155\57\x72\x65\143\x61\x70\164\x63\x68\x61\57\141\x70\x69\57\x73\x69\x74\145\x76\x65\x72\x69\x66\171";
        $lt = '';
        if (get_option("\155\157\137\x6f\160\145\156\151\x64\x5f\x72\x65\x63\x61\160\164\143\150\141\x5f\164\171\x70\x65") == 0) {
            goto jII;
        }
        $lt = get_option("\x6d\x6f\x5f\x6f\x70\145\x6e\x69\144\x5f\162\145\143\x61\x70\x74\x63\150\x61\x5f\x73\145\x63\162\x65\164\137\153\145\x79\137\166\62");
        goto NNh;
        jII:
        $lt = get_option("\155\x6f\x5f\157\x70\145\156\151\144\137\162\x65\143\141\160\164\x63\150\141\x5f\163\145\x63\x72\145\x74\137\153\145\x79\x5f\x76\63");
        NNh:
        $tc = array("\162\145\163\160\157\x6e\163\x65" => urlencode($_POST["\147\x2d\162\145\143\x61\x70\164\x63\150\x61\55\162\x65\163\x70\157\x6e\x73\145"]), "\163\145\x63\162\x65\164" => $lt, "\162\x65\x6d\157\x74\x65\151\160" => $ST);
        $Tt = '';
        foreach ($tc as $Pq => $Zx) {
            $Tt .= $Pq . "\x3d" . $Zx . "\x26";
            f5Q:
        }
        zuO:
        rtrim($Tt, "\x26");
        $Jm = array("\x6d\145\164\150\157\x64" => "\120\117\123\x54", "\142\157\144\171" => $Tt, "\164\x69\x6d\145\157\165\x74" => "\x35", "\162\x65\144\x69\x72\145\143\164\151\x6f\156" => "\x35", "\x68\164\x74\160\x76\x65\162\163\151\157\x6e" => "\x31\56\60", "\x62\154\x6f\143\x6b\x69\x6e\x67" => true, "\150\x65\141\x64\145\x72\x73" => $tc);
        $Mb = $uV->mo_openid_wp_remote_post($sM, $Jm);
        $sg = json_decode($Mb["\142\x6f\144\171"], true);
        fxt:
        return $sg["\x73\x75\143\143\x65\x73\163"];
    }
    function test_configuration()
    {
        $uV = new CustomerOpenID();
        if (!isset($_POST["\x67\55\162\145\143\x61\x70\164\x63\150\141\x2d\162\x65\x73\x70\x6f\156\x73\x65"])) {
            goto DLc;
        }
        $ST = $this->mo_openid_get_client_ip();
        $sM = "\x68\164\164\160\x73\72\x2f\57\x77\167\167\x2e\x67\157\157\147\154\145\56\143\157\x6d\57\162\x65\x63\141\160\164\143\x68\x61\x2f\x61\160\151\x2f\163\151\164\145\166\145\162\151\146\171";
        $lt = '';
        if (get_option("\x6d\157\137\157\x70\145\x6e\151\144\137\x72\145\x63\x61\x70\x74\x63\150\141\137\x74\x79\160\x65") == 0) {
            goto hga;
        }
        $lt = get_option("\x6d\157\x5f\157\x70\145\x6e\x69\x64\x5f\x72\x65\x63\141\x70\x74\x63\x68\141\137\x73\x65\143\162\x65\x74\137\153\x65\171\137\x76\62");
        goto StC;
        hga:
        $lt = get_option("\155\x6f\x5f\x6f\160\x65\x6e\x69\x64\137\162\145\x63\x61\x70\164\x63\150\141\137\x73\145\x63\162\x65\164\x5f\153\145\x79\x5f\166\x33");
        StC:
        $tc = array("\162\x65\x73\160\157\x6e\163\145" => urlencode($_POST["\147\x2d\162\x65\143\x61\160\164\x63\150\141\55\162\x65\x73\x70\x6f\x6e\163\145"]), "\163\x65\143\162\x65\164" => $lt, "\162\145\x6d\x6f\x74\x65\x69\160" => $ST);
        $Tt = '';
        foreach ($tc as $Pq => $Zx) {
            $Tt .= $Pq . "\75" . $Zx . "\46";
            sjO:
        }
        SUB:
        rtrim($Tt, "\x26");
        $Jm = array("\x6d\x65\164\150\157\x64" => "\120\x4f\x53\x54", "\x62\157\x64\x79" => $Tt, "\x74\151\x6d\145\157\165\164" => "\65", "\x72\x65\144\x69\162\x65\x63\x74\x69\x6f\x6e" => "\65", "\150\164\x74\160\x76\145\162\x73\x69\157\x6e" => "\61\x2e\60", "\142\x6c\x6f\143\153\x69\156\x67" => true, "\150\145\141\x64\x65\162\x73" => $tc);
        $Mb = $uV->mo_openid_wp_remote_post($sM, $Jm);
        if (empty($Mb["\x62\x6f\144\x79"])) {
            goto ryG;
        }
        $sg = json_decode($Mb["\142\x6f\x64\x79"], true);
        if (isset($sg["\145\x72\x72\x6f\162\x2d\143\x6f\x64\145\163"]) && in_array("\x69\x6e\x76\141\154\151\x64\55\151\156\x70\x75\164\55\163\145\x63\162\145\164", $sg["\145\x72\x72\157\x72\55\143\x6f\144\x65\x73"])) {
            goto S1a;
        }
        if (isset($sg["\163\x75\x63\x63\145\163\x73"]) && $sg["\163\x75\x63\x63\145\x73\163"] == 1) {
            goto aCg;
        }
        echo "\74\142\162\76\74\x62\162\76\x3c\x68\62\x20\163\x74\171\x6c\145\x3d\x63\x6f\x6c\157\162\72\162\145\x64\73\164\145\x78\164\x2d\x61\x6c\151\x67\x6e\x3a\143\x65\156\164\x65\162\76\111\156\166\141\154\151\144\x20\x63\141\x70\164\x63\150\141\56\40\x50\x6c\x65\x61\163\145\40\164\162\x79\x20\x61\x67\x61\x69\x6e\56\x3c\x2f\150\x32\x3e";
        goto One;
        aCg:
        echo "\x3c\142\162\x3e\x3c\142\162\76\74\150\x32\x20\x73\164\x79\154\145\75\x63\x6f\x6c\x6f\x72\x3a\147\x72\145\145\156\73\164\x65\170\164\55\141\154\151\x67\156\x3a\x63\x65\x6e\x74\145\162\x3e\x54\145\x73\x74\40\167\x61\x73\40\x73\x75\143\143\145\x73\x73\x66\165\154\40\141\156\144\40\x63\x61\160\164\143\150\141\40\166\x65\162\151\x66\151\x65\x64\56\74\57\150\x32\x3e";
        One:
        goto H5A;
        S1a:
        echo "\x3c\142\162\x3e\x3c\x62\x72\x3e\x3c\x68\62\x20\x73\164\x79\154\145\x3d\143\x6f\x6c\157\162\x3a\x72\145\x64\x3b\x74\x65\x78\164\55\x61\154\x69\x67\x6e\72\x63\x65\x6e\164\145\162\x3e\111\x6e\x76\x61\x6c\151\144\x20\123\145\143\162\x65\164\x20\x4b\145\x79\x2e\74\x2f\x68\x32\76";
        H5A:
        ryG:
        DLc:
        echo "\x20\x20\x20\x20\x20\40\40\40\74\163\x63\x72\151\160\164\x20\163\x72\x63\75\x27\x68\164\164\x70\163\72\57\x2f\x77\x77\167\56\x67\x6f\x6f\x67\x6c\145\56\x63\157\x6d\x2f\x72\x65\143\141\160\164\x63\150\x61\57\x61\160\x69\56\x6a\x73\x27\76\x3c\57\163\143\162\x69\x70\164\x3e\xd\12\40\40\x20\40\40\x20\40\40\x3c\x64\x69\x76\40\163\164\x79\x6c\145\x3d\42\x6d\141\162\147\151\x6e\72\60\x70\x78\x20\141\x75\164\x6f\x3b\167\x69\144\x74\150\72\63\x35\60\160\170\x22\76\xd\12\x20\40\40\x20\x20\x20\40\x20\x20\40\x20\x20\x3c\x62\162\x3e\74\x62\x72\x3e\x3c\x68\x32\76\x54\145\163\x74\40\147\x6f\157\147\154\145\x20\162\145\x43\101\x50\x54\x43\x48\101\x20\x6b\145\171\163\x3c\57\150\62\x3e\xd\xa\x20\x20\x20\x20\x20\40\40\x20\x20\40\x20\40\x3c\x66\157\x72\155\x20\x6d\145\x74\x68\x6f\x64\75\42\x70\157\x73\164\x22\x3e\xd\12\x20\40\x20\40\x20\x20\x20\x20\40\x20\40\40\x20\40\40\40\74\144\x69\166\x3e";
        activate_recaptcha();
        echo "\x3c\x2f\x64\x69\166\76\15\xa\x20\40\x20\40\x20\40\40\40\40\x20\40\x20\x20\40\40\40\x3c\x62\162\76\74\151\156\160\165\x74\40\164\171\x70\x65\x3d\x22\163\x75\142\155\x69\164\x22\40\x76\x61\x6c\165\x65\75\42\124\145\x73\x74\40\113\145\171\x73\x22\40\x63\x6c\x61\x73\x73\75\x22\142\165\164\164\x6f\156\x20\x62\165\x74\164\157\156\x2d\160\x72\151\x6d\141\x72\171\40\x62\x75\x74\164\x6f\156\55\x6c\141\x72\x67\145\42\x3e\15\12\40\x20\40\40\x20\40\x20\x20\40\x20\40\x20\x3c\x2f\x66\157\x72\155\x3e\15\xa\40\40\x20\x20\40\40\x20\x20\74\x2f\144\x69\166\76\15\12\x20\40\40\40\40\x20\x20\40";
        exit;
    }
}
function activate_recaptcha()
{
    if (!get_option("\x6d\x6f\x5f\157\160\x65\156\x69\144\x5f\163\x6f\143\151\x61\154\137\x6c\157\147\151\156\137\x72\x65\143\141\160\164\x63\x68\141")) {
        goto TXp;
    }
    if (get_option("\155\157\137\157\160\145\x6e\x69\144\137\162\145\143\141\160\x74\x63\x68\141\x5f\x74\x79\160\x65") == 1) {
        goto HAy;
    }
    echo "\74\x69\x6e\x70\165\164\40\164\x79\160\145\x3d\42\x68\x69\144\144\x65\x6e\42\40\151\x64\75\42\x67\55\162\145\143\x61\160\164\143\x68\141\x2d\162\x65\163\160\157\156\x73\145\42\40\156\141\155\x65\75\x22\x67\55\162\x65\x63\141\160\164\143\x68\141\x2d\x72\145\163\x70\x6f\x6e\163\145\x22\x3e\15\12\x9\11\x9\40\40\x20\40\x20\x20\40\40\x3c\163\x63\162\x69\x70\x74\40\x73\x72\143\75\x22\150\164\x74\160\x73\x3a\57\x2f\167\x77\167\x2e\x67\157\x6f\x67\x6c\x65\x2e\x63\x6f\x6d\x2f\x72\145\x63\141\160\x74\143\150\x61\x2f\x61\160\x69\x2e\x6a\x73\77\x72\x65\x6e\x64\145\162\x3d" . get_option("\155\x6f\x5f\x6f\160\x65\x6e\x69\x64\x5f\x72\145\x63\x61\160\x74\x63\150\141\x5f\163\151\164\145\137\x6b\x65\x79\137\166\x33") . "\42\x3e\x3c\x2f\x73\x63\162\151\160\x74\76\15\12\11\x9\x9\11\x9\x3c\x73\x63\162\151\160\164\x3e\15\12\11\x9\x9\40\x20\40\40\40\x20\x20\x20\40\40\40\x20\147\162\145\x63\x61\160\164\143\150\141\56\x72\x65\x61\144\x79\50\x66\165\156\143\x74\151\157\x6e\x28\51\40\173\15\xa\x9\x9\x9\x20\40\x20\x20\x20\x20\40\x20\x20\40\40\40\40\40\x20\40\x67\162\145\x63\x61\160\164\x63\150\x61\x2e\145\170\145\x63\x75\x74\145\50\x22" . get_option("\155\157\x5f\157\x70\145\x6e\x69\x64\x5f\162\145\x63\141\x70\x74\x63\150\x61\x5f\x73\x69\x74\145\137\x6b\145\171\137\x76\x33") . "\x22\x2c\x20\x7b\x61\143\164\x69\x6f\156\72\40\42\x6c\157\147\x69\x6e\42\x7d\51\x2e\164\x68\x65\156\x28\146\165\156\x63\x74\x69\157\x6e\x28\x74\x6f\153\x65\156\x29\x20\173\15\12\11\x9\x20\40\x20\40\x20\40\x20\x20\x20\x20\40\40\x20\40\x20\x20\x20\40\40\40\40\40\40\40\144\x6f\x63\x75\x6d\145\x6e\x74\x2e\x67\x65\164\105\x6c\145\x6d\145\x6e\x74\102\171\111\144\x28\42\147\x2d\x72\145\x63\x61\x70\164\x63\x68\x61\x2d\162\145\163\160\157\x6e\163\x65\x22\51\56\166\141\154\165\145\40\x3d\40\164\x6f\x6b\145\156\x3b\xd\xa\11\x9\11\x9\40\40\x20\40\x20\40\x20\x20\40\40\40\40\x7d\51\73\15\12\x9\x9\x9\40\40\40\x20\40\40\40\40\x20\40\40\x20\x7d\51\73\xd\xa\x9\11\x9\x9\40\x20\x20\40\x3c\57\x73\x63\162\151\160\164\x3e";
    goto hHS;
    HAy:
    echo "\74\x73\x63\162\x69\x70\x74\40\x73\162\x63\75\47\150\x74\x74\x70\163\x3a\57\57\167\167\167\x2e\147\157\157\147\x6c\145\x2e\x63\x6f\x6d\57\x72\x65\143\141\160\164\143\x68\x61\57\141\x70\151\x2e\152\163\47\x3e\74\x2f\163\143\162\x69\160\x74\x3e";
    echo "\x3c\x64\x69\166\x20\x63\154\141\x73\x73\x3d\42\x67\55\x72\x65\143\x61\160\x74\x63\x68\x61\42\x20\x64\x61\164\x61\55\x73\x69\x74\145\153\145\x79\x3d\42" . get_option("\x6d\157\x5f\157\160\145\x6e\x69\144\137\162\145\x63\x61\160\x74\x63\150\141\x5f\163\151\164\x65\x5f\x6b\145\171\137\x76\x32") . "\x22\x3e\74\x2f\144\151\166\x3e";
    echo "\74\x73\x74\x79\x6c\145\76\43\x6c\x6f\147\x69\x6e\x7b\x20\167\151\144\164\150\72\x33\x34\71\x70\x78\73\160\x61\x64\x64\151\156\147\72\62\x25\x20\60\40\x30\x3b\40\175\56\147\x2d\x72\145\143\x61\x70\164\x63\x68\141\173\155\141\x72\147\151\156\x2d\x62\x6f\164\x74\157\x6d\x3a\x35\45\x3b\175\43\154\157\x67\151\x6e\x66\157\162\x6d\173\160\141\x64\144\151\x6e\x67\x2d\142\157\164\x74\157\155\x3a\62\60\160\x78\73\175\74\x2f\163\164\x79\x6c\145\x3e";
    hHS:
    TXp:
}
function custom_authenticate_login($user, $U1, $ls)
{
    if (empty($U1) && empty($ls)) {
        goto jHD;
    }
    if (!(empty($U1) || empty($ls))) {
        goto Hqo;
    }
    $y5 = new WP_Error();
    if (!empty($U1)) {
        goto sU6;
    }
    $y5->add("\x65\155\160\x74\x79\x5f\x75\x73\x65\x72\x6e\141\x6d\x65", __("\x3c\163\164\x72\x6f\156\147\x3e\105\122\122\x4f\122\x3c\57\x73\164\162\x6f\156\147\76\x3a\40\x55\163\145\162\156\x61\155\145\x20\146\x69\x65\x6c\144\x20\151\163\40\145\155\x70\x74\171\x2e"));
    sU6:
    if (!empty($ls)) {
        goto jFk;
    }
    $y5->add("\145\155\x70\164\x79\x5f\160\x61\163\163\167\x6f\x72\144", __("\74\x73\164\x72\157\156\147\76\x45\122\x52\117\x52\74\x2f\163\x74\x72\157\x6e\147\x3e\72\40\120\x61\x73\x73\167\x6f\162\144\x20\x66\151\145\x6c\x64\40\x69\163\40\x65\155\160\164\171\56"));
    jFk:
    return $y5;
    Hqo:
    goto zg3;
    jHD:
    $y5 = new WP_Error();
    return $y5;
    zg3:
    $user = get_user_by("\154\x6f\147\151\x6e", $U1);
    $y5 = new WP_Error();
    if (!$user) {
        goto r2X;
    }
    if (!($user && wp_check_password($ls, $user->data->user_pass, $user->ID))) {
        goto cSK;
    }
    if (!(get_option("\x6d\157\137\157\x70\145\x6e\x69\144\x5f\x61\143\164\x69\166\141\164\145\x5f\x72\x65\143\x61\160\x74\x63\x68\141\x5f\x66\x6f\x72\137\154\157\147\151\156") && get_option("\x6d\157\137\157\160\145\x6e\x69\x64\x5f\x73\x6f\x63\151\x61\x6c\137\x6c\157\147\151\x6e\137\x72\145\143\141\160\164\x63\150\x61"))) {
        goto t30;
    }
    $X4 = new Mo_Openid_Recaptcha();
    if (!$X4->verify()) {
        goto Vzt;
    }
    return $user;
    goto iAH;
    Vzt:
    $y5->add("\x72\x65\143\141\x70\x74\x63\150\x61\x5f\x65\162\x72\157\162", __("\74\163\164\x72\x6f\x6e\147\76\105\x52\122\x4f\x52\x3c\x2f\x73\x74\162\157\156\147\76\40\72\x20\111\156\x76\x61\x6c\151\144\40\143\141\160\164\143\x68\x61\56\x20\120\x6c\145\x61\x73\145\40\x76\145\x72\151\x66\171\40\143\x61\x70\x74\143\x68\141\40\x61\147\x61\151\x6e\56"));
    return $y5;
    iAH:
    t30:
    cSK:
    r2X:
}
