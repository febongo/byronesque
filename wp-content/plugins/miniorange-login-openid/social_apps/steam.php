<?php


class mo_steam
{
    public $color = "\x23\x31\142\x32\x38\x33\70";
    public $scope = "\160\x72\157\146\151\x6c\x65";
    public $instructions;
    public function __construct()
    {
        $this->site_url = get_option("\163\x69\164\x65\165\162\x6c");
        $this->instructions = "\x47\157\x20\164\x6f\x20\74\141\x20\150\162\x65\x66\75\42\x68\x74\164\160\x73\x3a\x2f\57\163\x74\x65\141\155\x63\157\155\155\165\x6e\151\164\171\x2e\x63\157\155\57\144\145\x76\57\141\160\x69\153\x65\171\42\x20\x74\141\x72\x67\145\x74\x3d\42\x5f\x62\154\x61\156\x6b\x22\x3e\150\x74\x74\160\163\x3a\x2f\x2f\x73\164\145\141\155\x63\157\x6d\155\165\156\151\164\171\x2e\143\157\155\57\144\145\x76\x2f\x61\160\151\x6b\x65\x79\74\57\x61\76\x20\x61\x6e\x64\40\x73\x69\147\x6e\40\x69\156\x20\x77\151\164\150\x20\x79\157\x75\x72\40\x53\164\x65\x61\x6d\x20\141\x63\x63\157\x75\x6e\x74\x2e\xd\12\x20\x20\x20\40\x20\40\x20\40\40\40\40\x20\40\40\40\40\x20\x20\40\x20\40\x20\x20\x20\x20\x20\40\40\43\x23\117\156\x20\x74\150\x65\40\160\141\x67\x65\x2c\x20\105\156\x74\x65\x72\x20\74\x62\x3e\74\143\x6f\144\x65\x20\151\x64\75\47\63\x39\x27\76" . get_option("\x73\x69\x74\x65\x75\x72\154") . "\74\57\143\x6f\144\x65\76\x3c\151\x20\163\x74\x79\x6c\145\75\x20\x22\x77\x69\x64\x74\150\x3a\40\x31\x31\160\170\73\x68\145\x69\x67\x68\x74\x3a\x20\x39\160\170\x3b\160\x61\144\x64\151\156\147\55\154\145\146\x74\72\x32\160\x78\x3b\x70\141\144\144\x69\156\147\55\164\x6f\x70\x3a\x33\x70\170\x22\40\x63\154\141\163\163\75\42\146\141\40\x66\141\55\146\167\x20\146\x61\55\154\147\40\x66\141\x2d\143\x6f\x70\x79\40\155\157\x5f\143\157\x70\x79\x20\155\x6f\137\x6f\x70\x65\156\x69\144\x5f\x63\x6f\x70\171\x74\157\157\154\164\151\160\x22\x20\157\x6e\143\x6c\151\143\153\75\x22\x63\157\160\x79\x54\x6f\103\154\x69\x70\x62\x6f\141\x72\144\x28\x74\x68\x69\163\x2c\40\x27\x23\x33\71\x27\x2c\40\x27\43\163\x68\x6f\x72\164\143\157\144\145\x5f\x75\x72\x6c\x33\71\137\143\157\160\x79\x27\51\42\76\x3c\x73\160\141\x6e\x20\x69\144\x3d\42\163\150\157\162\164\143\x6f\x64\x65\137\165\162\154\x33\x39\137\x63\x6f\160\171\42\x20\x63\154\x61\163\x73\x3d\x22\x6d\x6f\x5f\x6f\160\x65\x6e\x69\x64\x5f\143\157\x70\171\164\157\157\x6c\164\151\x70\x74\x65\170\164\x22\x3e\103\x6f\160\x79\x20\164\157\40\103\154\151\x70\142\157\141\x72\x64\x3c\x2f\163\160\x61\x6e\76\x3c\x2f\151\76\x3c\x2f\x62\76\x61\163\x20\x79\157\x75\162\40\74\x62\x3e\x41\160\x70\x20\x44\157\x6d\x61\151\x6e\x3c\x2f\x62\76\x2e\xd\12\x20\x20\40\x20\x20\40\40\x20\40\40\x20\x20\x20\40\40\x20\40\x20\40\x20\40\x20\x20\40\40\x20\x20\x20\x23\x23\103\x6c\151\143\153\40\x6f\x6e\40\164\x68\145\x20\143\150\145\143\x6b\x62\157\170\40\164\x68\141\x74\40\x61\x70\160\145\141\162\x73\x20\x74\157\40\141\x67\162\145\x65\40\164\x6f\x20\74\142\76\123\x74\x65\x61\x6d\40\127\145\142\x20\101\x50\x49\40\124\x65\162\x6d\x73\x20\157\146\40\x55\x73\x65\x3c\x2f\x62\76\x2e\x20\xd\12\x20\x20\40\40\x20\40\x20\x20\40\40\40\40\40\40\x20\40\40\40\x20\x20\x20\x20\x20\40\40\x20\x20\x20\43\x23\x43\x6c\151\143\x6b\40\157\x6e\40\x3c\x62\76\x52\x65\147\151\x73\164\145\162\74\57\x62\76\x2e\xd\xa\x20\x20\x20\40\40\40\40\x20\x20\x20\40\40\40\x20\40\x20\40\40\40\x20\40\40\40\40\x20\40\x20\x20\43\43\x43\x6f\160\x79\x20\164\150\x65\x20\x3c\x62\76\x53\x74\x65\141\155\40\x57\145\142\x20\x41\x50\111\x20\113\145\x79\x3c\x2f\142\x3e\x20\x61\156\x64\x20\160\141\163\164\x65\x20\151\164\x20\141\163\40\74\142\76\103\x6c\151\x65\x6e\x74\40\x49\x44\x3c\57\142\x3e\56\x20\15\12\x20\40\x20\40\x20\40\x20\x20\x20\40\40\40\40\40\x20\x20\40\40\40\40\x20\x20\40\x20\x20\x20\x20\x20\43\43\103\154\151\143\x6b\x20\157\x6e\40\164\150\145\x20\123\x61\x76\x65\x20\x26\x20\x54\145\163\164\40\x43\157\156\x66\x69\x67\165\162\141\164\151\x6f\x6e\40\x62\165\x74\x74\x6f\156\56\15\12\x20\x20\x20\x20\40\40\x20\x20\x20\x20\40\x20\40\40\40\40\40\x20\x20\40\40\x20\40\40\40\x20\x20\40\x23\x23\107\x6f\40\164\157\40\123\157\143\151\141\154\40\x4c\x6f\x67\x69\x6e\40\164\141\x62\x20\x74\x6f\40\143\x6f\x6e\146\151\147\165\x72\145\x20\x74\150\x65\40\x64\x69\x73\160\154\x61\171\40\141\163\x20\167\x65\154\x6c\40\x61\163\x20\x6f\x74\150\145\162\40\x6c\x6f\147\151\156\x20\x73\x65\x74\164\151\156\147\x73";
    }
    function mo_openid_get_app_code()
    {
        $i0 = maybe_unserialize(get_option("\155\157\x5f\157\160\x65\x6e\151\144\x5f\141\x70\160\x73\137\x6c\151\163\x74"));
        $vA = get_social_app_redirect_uri("\x73\x74\x65\x61\x6d");
        mo_openid_start_session();
        $_SESSION["\141\x70\160\156\141\x6d\x65"] = "\x73\x74\145\x61\x6d";
        $cS = $i0["\163\164\x65\x61\155"]["\x63\154\x69\x65\x6e\164\x69\x64"];
        $kf = "\x68\164\164\x70\x73\72\x2f\x2f\x73\x74\145\x61\155\143\x6f\155\x6d\x75\x6e\151\x74\x79\x2e\143\157\155\57\x6f\160\x65\156\151\x64\57\x6c\x6f\x67\x69\156";
        $yQ = null;
        $ID = null;
        $C7 = !empty($_SERVER["\110\x54\x54\120\x53"]) || !empty($_SERVER["\x48\124\124\x50\x5f\130\x5f\106\x4f\122\x57\x41\122\104\x45\104\x5f\x50\x52\x4f\124\x4f"]) && $_SERVER["\110\x54\x54\120\137\130\x5f\106\117\122\127\101\x52\x44\x45\x44\137\x50\x52\x4f\124\117"] == "\x68\164\x74\160\163";
        if (!is_null($yQ)) {
            goto C7V;
        }
        if ($ID == null) {
            goto ybf;
        }
        $yQ = $ID . $_SERVER["\x53\103\x52\x49\120\x54\137\116\x41\115\105"];
        goto cWn;
        ybf:
        $yQ = ($C7 ? "\150\164\x74\160\x73" : "\150\x74\x74\x70") . "\x3a\x2f\x2f" . $_SERVER["\110\124\x54\120\x5f\110\x4f\123\124"] . $_SERVER["\x53\x43\x52\111\120\124\x5f\116\101\115\105"];
        cWn:
        goto VuX;
        C7V:
        if ($this->validateUrl($yQ)) {
            goto HNE;
        }
        throw new Exception("\124\x68\145\40\x72\x65\164\165\x72\156\40\x55\122\x4c\40\x6d\165\x73\164\40\x62\x65\40\x61\x20\x76\x61\154\151\x64\x20\125\x52\x4c\x20\x77\151\x74\x68\x20\x61\x20\x55\122\111\x20\123\143\150\145\155\x65\40\x6f\x72\40\x68\x74\164\160\40\157\x72\40\150\x74\164\x70\x73\x2e");
        HNE:
        VuX:
        $ZF = array("\x6f\x70\145\156\151\144\56\x6e\163" => "\x68\164\164\160\72\57\x2f\163\x70\x65\143\163\x2e\x6f\160\145\156\x69\144\56\156\145\164\57\141\165\164\x68\57\62\56\60", "\x6f\160\145\156\151\x64\56\155\x6f\144\145" => "\143\x68\145\143\x6b\151\x64\137\163\x65\164\165\x70", "\x6f\160\145\x6e\151\144\x2e\162\x65\x74\x75\x72\156\x5f\x74\x6f" => $yQ, "\157\x70\145\156\151\144\x2e\162\x65\x61\x6c\x6d" => $ID != null ? $ID : ($C7 ? "\x68\x74\x74\x70\163" : "\150\x74\164\x70") . "\x3a\x2f\57" . $_SERVER["\110\124\x54\120\x5f\110\x4f\x53\x54"], "\x6f\x70\x65\x6e\x69\144\56\x69\x64\145\156\x74\151\164\x79" => "\150\x74\x74\160\72\57\57\x73\x70\145\143\x73\x2e\x6f\160\x65\x6e\x69\x64\x2e\156\145\x74\x2f\x61\x75\x74\150\57\62\x2e\x30\57\x69\x64\x65\x6e\164\x69\146\151\x65\x72\x5f\163\x65\154\x65\x63\164", "\157\160\x65\x6e\x69\144\56\143\154\141\151\155\x65\x64\137\x69\144" => "\x68\164\164\160\x3a\57\x2f\x73\x70\145\x63\163\x2e\x6f\x70\x65\156\151\x64\x2e\156\x65\x74\x2f\x61\x75\164\150\x2f\62\56\x30\57\x69\144\x65\x6e\x74\x69\x66\151\x65\x72\x5f\163\x65\x6c\145\143\x74");
        $Ur = $kf . "\x3f" . http_build_query($ZF);
        header("\x4c\157\143\x61\x74\151\x6f\x6e\72" . $Ur);
        exit;
    }
    function mo_openid_get_access_token()
    {
        $oX = null;
        if (!(isset($_REQUEST["\157\160\x65\156\151\x64\137\x6f\160\137\x65\x6e\x64\x70\157\151\x6e\x74"]) && isset($_REQUEST["\157\x70\x65\x6e\151\144\x5f\143\x6c\x61\151\155\x65\x64\x5f\x69\x64"]))) {
            goto UG1;
        }
        $u5 = $_REQUEST["\x6f\160\145\x6e\x69\144\x5f\143\154\x61\151\x6d\145\144\137\151\x64"];
        $Lh = explode("\x2f", $u5);
        $oX = $Lh[5];
        UG1:
        $vA = get_social_app_redirect_uri("\x73\x74\145\x61\155");
        $i0 = maybe_unserialize(get_option("\155\157\137\157\x70\145\156\151\x64\137\x61\x70\x70\x73\137\154\151\163\x74"));
        $cS = $i0["\x73\x74\x65\x61\155"]["\143\x6c\151\145\x6e\164\x69\x64"];
        $Ux = "\x68\164\164\x70\x3a\57\x2f\x61\160\151\x2e\163\164\145\x61\x6d\x70\x6f\x77\145\x72\x65\x64\56\x63\x6f\155\x2f\111\x53\x74\x65\x61\x6d\x55\163\145\x72\57\x47\x65\x74\x50\154\141\x79\x65\162\x53\x75\x6d\155\x61\x72\x69\x65\x73\x2f\x76\x30\x30\60\x32\x2f\x3f\153\x65\171\x3d" . $cS . "\x26\163\164\x65\x61\155\151\144\163\75" . $oX;
        $t9 = "\150\x74\164\x70\72\57\x2f\x61\x70\x69\56\163\164\145\x61\x6d\x70\157\x77\x65\x72\x65\x64\x2e\143\157\x6d\57\x49\123\x74\145\x61\155\125\163\x65\x72\x2f\107\145\164\120\154\x61\x79\x65\162\123\165\x6d\x6d\x61\x72\x69\x65\x73\57\166\x30\x30\x30\62\57\x3f\153\x65\171\x3d" . $cS . "\x26\x73\164\x65\141\155\151\x64\x73\75" . $oX;
        $Er = mo_openid_get_social_app_data('', $t9, "\x73\164\x65\141\155");
        if (!(is_user_logged_in() && get_option("\x6d\x6f\x5f\x6f\x70\145\x6e\151\144\137\x74\x65\x73\164\x5f\x63\157\156\146\x69\147\165\x72\141\164\x69\157\156") == 1)) {
            goto D5P;
        }
        mo_openid_app_test_config($Er);
        D5P:
        $l4 = $XL = $SW = $gG = $EK = $Go = $Zo = '';
        $Ku = $Me = $JC = $Du = $u1 = $ww = $QD = '';
        if (!isset($Er["\x72\x65\x73\160\x6f\156\x73\x65"]["\160\x6c\141\x79\x65\x72\163"]["\60"]["\160\x65\162\x73\157\156\141\x6e\141\x6d\x65"])) {
            goto PJq;
        }
        $gG = isset($Er["\x72\145\x73\160\x6f\x6e\163\145"]["\160\154\141\171\x65\162\163"]["\60"]["\160\x65\x72\x73\x6f\x6e\x61\156\x61\155\x65"]) ? $Er["\x72\x65\163\160\x6f\x6e\163\x65"]["\x70\x6c\x61\171\145\x72\163"]["\x30"]["\x70\145\x72\163\157\156\x61\156\141\x6d\145"] : '';
        $Vx = explode("\x20", $gG);
        $l4 = isset($Vx[0]) ? $Vx[0] : '';
        $XL = isset($Vx[1]) ? $Vx[1] : '';
        PJq:
        $SW = isset($Er["\162\145\x73\160\157\156\163\145"]["\x70\154\x61\171\x65\162\163"]["\x30"]["\x65\155\141\151\x6c"]) ? $Er["\162\x65\163\x70\157\x6e\x73\x65"]["\x70\154\x61\x79\x65\162\163"]["\x30"]["\145\155\141\151\154"] : '';
        $Zo = isset($Er["\x72\145\x73\160\157\156\x73\145"]["\x70\154\141\171\145\162\x73"]["\60"]["\163\164\x65\x61\155\151\x64"]) ? $Er["\162\x65\x73\x70\x6f\x6e\163\x65"]["\x70\154\x61\171\145\x72\x73"]["\60"]["\163\x74\x65\141\x6d\x69\144"] : '';
        $Go = isset($Er["\x72\145\163\x70\157\156\x73\x65"]["\160\154\x61\x79\x65\x72\x73"]["\x30"]["\141\166\x61\164\x61\162"]) ? $Er["\x72\145\163\160\x6f\156\x73\x65"]["\160\154\141\171\145\162\163"]["\x30"]["\141\166\141\x74\x61\x72"] : '';
        $EK = isset($Er["\x72\145\163\x70\x6f\156\163\145"]["\160\x6c\141\x79\145\162\x73"]["\60"]["\x70\x72\157\x66\x69\154\x65\165\162\154"]) ? $Er["\x72\145\163\160\157\x6e\x73\145"]["\x70\154\141\171\x65\162\x73"]["\x30"]["\160\162\157\146\151\154\x65\x75\162\154"] : '';
        $De = array("\x66\x69\162\x73\x74\x5f\x6e\x61\x6d\x65" => $l4, "\154\x61\x73\164\137\x6e\141\155\145" => $XL, "\x65\155\141\x69\154" => $SW, "\x75\x73\145\162\137\156\x61\x6d\145" => $gG, "\165\x73\145\162\x5f\165\x72\154" => $EK, "\165\163\x65\x72\x5f\160\x69\x63\x74\165\162\145" => $Go, "\x73\x6f\143\x69\141\x6c\137\x75\163\145\x72\x5f\151\144" => $Zo, "\154\x6f\143\x61\164\x69\157\x6e\137\143\x69\164\x79" => $Ku, "\x6c\x6f\x63\x61\x74\x69\157\156\x5f\x63\x6f\165\156\164\x72\171" => $Me, "\141\142\x6f\165\x74\x5f\155\x65" => $JC, "\143\157\155\x70\x61\156\x79\x5f\x6e\x61\x6d\145" => $Du, "\x66\x72\151\145\x6e\144\x5f\156\x6f\163" => $QD, "\147\x65\156\144\145\162" => $ww, "\141\147\x65" => $u1);
        return $De;
    }
}
